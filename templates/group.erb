
group <%= @group %> {
<% @hosts.each do |i| -%>
      host <%= i %>;
<% end -%>

<% unless @ssl -%>
      nossl;
<% end -%>
      key <%= @key_path %>;
<% @blocks.each do |b,v| %>
<% if v['includes'] -%>
<% v['includes'].each do |i| -%>
      include <%= i %>;
<% end -%>
<% end -%>
<% if v['excludes'] -%>
<% v['excludes'].each do |e| -%>
      exclude <%= e %>;
<% end -%>
<% end -%>
<% if v['actions'] -%>
<% v['actions'].each do |i,a| -%>
      action {
<% a['pattern'].each do |pattern| -%>
            pattern <%= pattern %>;
<% end -%>
<% a['exec'].each do |exec| -%>
            exec "<%= exec %>";
<% end -%>
<% if a['logfile'] -%>
            logfile "<%= a['logfile'] %>";
<% end -%>
            <%= a['do'] %>;
      }
<% end -%>
<% end -%>
<% end -%>

      auto <%= @auto %>;
}
